\begin{tikzpicture}[>=latex,text height=1.5ex,text depth=0.25ex,auto]
    % "text height" and "text depth" are required to vertically
    % align the labels with and without indices.
  
  % The various elements are conveniently placed using a matrix:
  \matrix[column sep=0.3cm,row sep=1.5cm] {
    % First line: Control input
    	&
		\node (e0)					{};&
		\node (e1)	[post]			{};&
		\node (e2)	[post]			{};&
		
		\only<1-2>{\node(a)	[space]	{};}
		\only<3->{\node (e3)	[post]	{};}&

		\only<1>{\node 	(a)  [space] {};}
		\only<2>{\node 	(e4)  [pvisit] {};}
		\only<3->{\node (e4) [visit] {};}&
		\node(e) 					{};
		&
        \\
		& & & &
		\node(eqn) {$f(\X)$};
		& & &\\
};
    
    % The diagram elements are now connected through arrows:

	\path[-] (e0) edge[thick]	(e1);
	\path[-] (e1) edge[thick]	(e2);
\only<1-2>{\path[-] (e2) edge[thick]	(e);}
\only<3->{\path[-] (e2) edge[thick]	(e3);}
\only<3->{\path[-] (e3) edge[thick]	(e4);}
\only<2->{\path[-] (e4) edge[thick]	(e);}
	\begin{pgfonlayer}{background}
		\only<1-3>{\node(input) [background,fit=(e1) (e2)] {};}
		\only<4->{\node [background,fit=(e2) (e3)] {};}
\end{pgfonlayer}

	\only<2>{ 

	\path[draw, -latex'] (input) |- node[near start] {$\X$} (eqn);
	\path[draw, -latex'] (eqn)   -| node[near start] {$\widehat{\dt}$} (e4);}


\end{tikzpicture}
